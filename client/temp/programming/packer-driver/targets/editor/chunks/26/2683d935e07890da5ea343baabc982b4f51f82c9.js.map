{"version":3,"sources":["file:///C:/Users/zzx/Desktop/naga123/client/assets/script/sgj/sgj_btn.ts"],"names":["_decorator","Component","Node","AudioMgr","ccclass","property","sgj_btn","tooltip","readonly","type","EventHandler","_touchCounter","_isTouching","start","update","deltaTime","onEnable","node","on","EventType","TOUCH_START","_onTouchStart","TOUCH_END","_onTouchEnd","TOUCH_CANCEL","_onTouchCancel","onDisable","off","event","publishOneTouch","isLongPress","schedule","_touchCounterCallback","touchInterval","unschedule","longTouchEvents","forEach","eventHandler","emit","handleToucheLogic","touchCounter","customEventData","console","log","inst","play","globalThis","sgj_view","addBetScore","addAllBetScore","sgj_normal","stop"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;;AACvBC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;yBAGjBM,O,WADZF,OAAO,CAAC,SAAD,C,UAEHC,QAAQ,CAAC;AACNE,QAAAA,OAAO,EAAE;AADH,OAAD,C,UAKRF,QAAQ,CAAC;AACNE,QAAAA,OAAO,EAAE;AADH,OAAD,C,UAKRF,QAAQ,CAAC;AACNG,QAAAA,QAAQ,EAAE,IADJ;AAEND,QAAAA,OAAO,EAAE;AAFH,OAAD,C,UAMRF,QAAQ,CAAC;AACNI,QAAAA,IAAI,EAAE,CAACR,SAAS,CAACS,YAAX,CADA;AAENH,QAAAA,OAAO,EAAE;AAFH,OAAD,C,2BAlBb,MACaD,OADb,SAC6BL,SAD7B,CACuC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAuB3BU,aAvB2B,GAuBH,CAvBG;AAAA,eAwB3BC,WAxB2B,GAwBJ,KAxBI;AAAA;;AA0BnCC,QAAAA,KAAK,GAAG,CAEP;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AAEDC,QAAAA,QAAQ,GAAG;AACP,eAAKC,IAAL,CAAUC,EAAV,CAAahB,IAAI,CAACiB,SAAL,CAAeC,WAA5B,EAAyC,KAAKC,aAA9C,EAA6D,IAA7D;AACA,eAAKJ,IAAL,CAAUC,EAAV,CAAahB,IAAI,CAACiB,SAAL,CAAeG,SAA5B,EAAuC,KAAKC,WAA5C,EAAyD,IAAzD;AACA,eAAKN,IAAL,CAAUC,EAAV,CAAahB,IAAI,CAACiB,SAAL,CAAeK,YAA5B,EAA0C,KAAKC,cAA/C,EAA+D,IAA/D;AACH;;AAEDC,QAAAA,SAAS,GAAG;AACR,eAAKT,IAAL,CAAUU,GAAV,CAAczB,IAAI,CAACiB,SAAL,CAAeC,WAA7B,EAA0C,KAAKC,aAA/C,EAA8D,IAA9D;AACA,eAAKJ,IAAL,CAAUU,GAAV,CAAczB,IAAI,CAACiB,SAAL,CAAeG,SAA7B,EAAwC,KAAKC,WAA7C,EAA0D,IAA1D;AACA,eAAKN,IAAL,CAAUU,GAAV,CAAczB,IAAI,CAACiB,SAAL,CAAeK,YAA7B,EAA2C,KAAKC,cAAhD,EAAgE,IAAhE;AACH;;AAEOJ,QAAAA,aAAa,CAACO,KAAD,EAAoB;AAErC,eAAKhB,WAAL,GAAmB,IAAnB,CAFqC,CAGrC;;AACA,eAAKiB,eAAL,GAJqC,CAMrC;;AACA,cAAI,KAAKC,WAAL,IAAoB,IAAxB,EAA8B;AAC1B,iBAAKlB,WAAL,GAAmB,IAAnB;AACH,WAFD,MAGK;AACD,iBAAKA,WAAL,GAAmB,KAAnB;AACA;AACH,WAboC,CAcrC;;;AACA,eAAKmB,QAAL,CAAc,KAAKC,qBAAnB,EAA0C,KAAKC,aAA/C;AACH;;AAEOV,QAAAA,WAAW,CAACK,KAAD,EAAoB;AACnC,eAAKhB,WAAL,GAAmB,KAAnB;AACA,eAAKD,aAAL,GAAqB,CAArB;AACA,eAAKuB,UAAL,CAAgB,KAAKF,qBAArB;AACH;;AAEOP,QAAAA,cAAc,CAACG,KAAD,EAAoB;AACtC,eAAKhB,WAAL,GAAmB,KAAnB;AACA,eAAKD,aAAL,GAAqB,CAArB;AACA,eAAKuB,UAAL,CAAgB,KAAKF,qBAArB;AACH;;AAEOA,QAAAA,qBAAqB,GAAG;AAC5B,cAAI,KAAKpB,WAAT,EAAsB;AAClB,iBAAKiB,eAAL;AACH,WAFD,MAEO;AACH,iBAAKK,UAAL,CAAgB,KAAKF,qBAArB;AACH;AACJ;AAED;AACJ;AACA;;;AACYH,QAAAA,eAAe,GAAG;AACtB,cAAI,CAAC,KAAKjB,WAAV,EAAuB;AACnB;AACH;;AACD,eAAKD,aAAL;AACA,eAAKwB,eAAL,CAAqBC,OAArB,CAA8BC,YAAD,IAAgC;AACzDA,YAAAA,YAAY,CAACC,IAAb,CAAkB,CAAC,KAAK3B,aAAN,CAAlB;AACH,WAFD;AAGH,SA/FkC,CAiGnC;;;AACA4B,QAAAA,iBAAiB,CAACC,YAAD,EAAuBC,eAAvB,EAA8C;AAE3DC,UAAAA,OAAO,CAACC,GAAR,CAAa,WAAb,EAAyBF,eAAzB;;AACA,kBAAQA,eAAR;AACI,iBAAK,IAAL;AACI;AACI;AAAA;AAAA,0CAASG,IAAT,CAAcC,IAAd,CAAmB,mBAAnB;AACAC,gBAAAA,UAAU,CAACC,QAAX,CAAoBC,WAApB,CAAgC,CAAhC;AACA;AACH;;AACL,iBAAK,IAAL;AACI;AACIF,gBAAAA,UAAU,CAACC,QAAX,CAAoBC,WAApB,CAAgC,CAAhC;AACA;AACH;;AACL,iBAAK,IAAL;AACI;AACIF,gBAAAA,UAAU,CAACC,QAAX,CAAoBC,WAApB,CAAgC,CAAhC;AACA;AACH;;AACL,iBAAK,IAAL;AACI;AACIF,gBAAAA,UAAU,CAACC,QAAX,CAAoBC,WAApB,CAAgC,CAAhC;AACA;AACH;;AACL,iBAAK,IAAL;AACI;AACIF,gBAAAA,UAAU,CAACC,QAAX,CAAoBC,WAApB,CAAgC,CAAhC;AACA;AACH;;AACL,iBAAK,IAAL;AACI;AACIF,gBAAAA,UAAU,CAACC,QAAX,CAAoBC,WAApB,CAAgC,CAAhC;AACA;AACH;;AACL,iBAAK,IAAL;AACI;AACIF,gBAAAA,UAAU,CAACC,QAAX,CAAoBC,WAApB,CAAgC,CAAhC;AACA;AACH;;AACL,iBAAK,IAAL;AACI;AACIF,gBAAAA,UAAU,CAACC,QAAX,CAAoBC,WAApB,CAAgC,CAAhC;AACA;AACH;;AACL,iBAAK,KAAL;AACI;AACIF,gBAAAA,UAAU,CAACC,QAAX,CAAoBE,cAApB;AACA;AACH;;AACL,iBAAK,IAAL;AACI;AACIH,gBAAAA,UAAU,CAACI,UAAX,CAAsBC,IAAtB;AACA;AACH;AAnDT;AAqDH;;AA1JkC,O;;;;;iBAIX,G;;;;;;;iBAKD,I;;;;;;;iBAMQ,K;;;;;;;iBAMG,E","sourcesContent":["import { _decorator, Component, Node, EventHandler, EventTouch, Sprite } from 'cc';\r\nimport { AudioMgr } from '../utils/audioMgr';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('sgj_btn')\r\nexport class sgj_btn extends Component {\r\n    @property({\r\n        tooltip: \"触摸回调间隔（秒）。假如为0.1，那么1秒内会回调10次 ${longTouchEvents} 事件数组\"\r\n    })\r\n    touchInterval: number = 0.2;\r\n\r\n    @property({\r\n        tooltip: \"是否支持长按\"\r\n    })\r\n    isLongPress: boolean = true;\r\n\r\n    @property({\r\n        readonly: true,\r\n        tooltip: \"是否支持多点触控（当前还不支持）\"\r\n    })\r\n    enableMultiTouching: boolean = false;\r\n\r\n    @property({\r\n        type: [Component.EventHandler],\r\n        tooltip: \"回调事件数组，每间隔 ${toucheInterval}s 回调一次\"\r\n    })\r\n    longTouchEvents: EventHandler[] = [];\r\n\r\n    private _touchCounter: number = 0;\r\n    private _isTouching: boolean = false;\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n\r\n    }\r\n\r\n    onEnable() {\r\n        this.node.on(Node.EventType.TOUCH_START, this._onTouchStart, this);\r\n        this.node.on(Node.EventType.TOUCH_END, this._onTouchEnd, this);\r\n        this.node.on(Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);\r\n    }\r\n\r\n    onDisable() {\r\n        this.node.off(Node.EventType.TOUCH_START, this._onTouchStart, this);\r\n        this.node.off(Node.EventType.TOUCH_END, this._onTouchEnd, this);\r\n        this.node.off(Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this);\r\n    }\r\n\r\n    private _onTouchStart(event: EventTouch) {\r\n\r\n        this._isTouching = true;\r\n        // 第一次触摸立即回调一次\r\n        this.publishOneTouch();\r\n\r\n        //不支持长按\r\n        if (this.isLongPress == true) {\r\n            this._isTouching = true;\r\n        }\r\n        else {\r\n            this._isTouching = false;\r\n            return;\r\n        }\r\n        // 然后开启计时器，计算后续的长按相当于触摸了多少次\r\n        this.schedule(this._touchCounterCallback, this.touchInterval);\r\n    }\r\n\r\n    private _onTouchEnd(event: EventTouch) {\r\n        this._isTouching = false;\r\n        this._touchCounter = 0;\r\n        this.unschedule(this._touchCounterCallback);\r\n    }\r\n\r\n    private _onTouchCancel(event: EventTouch) {\r\n        this._isTouching = false;\r\n        this._touchCounter = 0;\r\n        this.unschedule(this._touchCounterCallback);\r\n    }\r\n\r\n    private _touchCounterCallback() {\r\n        if (this._isTouching) {\r\n            this.publishOneTouch();\r\n        } else {\r\n            this.unschedule(this._touchCounterCallback);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 通知出去：被点击/触摸了一次，长按时，会连续多次回调这个方法\r\n     */\r\n    private publishOneTouch() {\r\n        if (!this._isTouching) {\r\n            return;\r\n        }\r\n        this._touchCounter++;\r\n        this.longTouchEvents.forEach((eventHandler: EventHandler) => {\r\n            eventHandler.emit([this._touchCounter]);\r\n        });\r\n    }\r\n\r\n    //处理逻辑事件\r\n    handleToucheLogic(touchCounter: number, customEventData?: any) {\r\n\r\n        console.log(`当前下注按钮 = `, customEventData);\r\n        switch (customEventData) {\r\n            case 'b1':\r\n                {\r\n                    AudioMgr.inst.play('sound/sgj/sgj_bt1')\r\n                    globalThis.sgj_view.addBetScore(1);\r\n                    break;\r\n                }\r\n            case 'b2':\r\n                {\r\n                    globalThis.sgj_view.addBetScore(2);\r\n                    break;\r\n                }\r\n            case 'b3':\r\n                {\r\n                    globalThis.sgj_view.addBetScore(3);\r\n                    break;\r\n                }\r\n            case 'b4':\r\n                {\r\n                    globalThis.sgj_view.addBetScore(4);\r\n                    break;\r\n                }\r\n            case 'b5':\r\n                {\r\n                    globalThis.sgj_view.addBetScore(5);\r\n                    break;\r\n                }\r\n            case 'b6':\r\n                {\r\n                    globalThis.sgj_view.addBetScore(6);\r\n                    break;\r\n                }\r\n            case 'b7':\r\n                {\r\n                    globalThis.sgj_view.addBetScore(7);\r\n                    break;\r\n                }\r\n            case 'b8':\r\n                {\r\n                    globalThis.sgj_view.addBetScore(8);\r\n                    break;\r\n                }\r\n            case 'all':\r\n                {\r\n                    globalThis.sgj_view.addAllBetScore();\r\n                    break;\r\n                }\r\n            case 'go':\r\n                {\r\n                    globalThis.sgj_normal.stop();\r\n                    break;\r\n                }\r\n        }\r\n    }\r\n\r\n}"]}