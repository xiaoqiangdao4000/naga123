{"version":3,"sources":["file:///Users/zzx/Desktop/naga123/client/assets/script/sgj/game_sgj.ts"],"names":["_decorator","Component","EventTarget","randomRangeInt","HTTP","ccclass","property","globalThis","sgjEvent","game_sgj","cmd_c_bet","type","data","cmd_c_bigSmall","cmd_s_bigSmall","iswin","bigsmall","wins_core","user_score","cmd_s_gameEnd","step","area","tiems","record","eventid","event_count","event_step","event_area","event_times","event_score","times","serverStepName","serverStepArea","gameState","start","curgame","sgj_normal","play","getServerData","t_step","bs","mybetscore","i","sgj_view","bet_score","t_area","winscore","update","deltaTime","onEnable","on","runCallBack","onDisable","off","arg1","console","log","setWinScore","onMessage","sendMssage","msg","getInstance","send","JSON","stringify"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, SpriteFrame, Sprite, resources, Prefab, instantiate, EventTarget, randomRangeInt } from 'cc';\nimport HTTP from '../utils/HTTP';\nimport { AudioMgr } from '../utils/AudioMgr';\n\nconst { ccclass, property } = _decorator;\n\nglobalThis.sgjEvent = new EventTarget();\n\n@ccclass('game_sgj')\nexport class game_sgj extends Component {\n\n    //客户端消息----下注\n    cmd_c_bet =\n        {\n            type: 'cmd_c_bet',\n            data: [0, 0, 0, 0, 0, 0, 0, 0],\n        }\n\n    //客户端消息----猜大小,//猜大小，0为小（0-7），1为大（8-15）\n    cmd_c_bigSmall =\n        {\n            type: 'cmd_c_bigSmall',\n            data: 0, //赌注\n        }\n\n    //服务端消息----猜大小\n    cmd_s_bigSmall =\n        {\n            type: 'cmd_s_bigSmall',\n            iswin: 0,    //猜大小成功 0失败，1成功。\n            bigsmall: 0, //大小的实际数值\n            wins_core: 0, //赢分\n            user_score: 0,//分数\n        }\n\n    //服务端消息----开奖       \n    cmd_s_gameEnd =\n        {\n            type: 'cmd_s_gameEnd',\n            step: 0,    //开奖格子\n            area: 0,    //开奖区域\n            tiems: 0,   //倍数\n            wins_core: 0,   //赢分\n            user_score: 0,  //分数\n            record: [0, 0, 0, 0, 0, 0, 0, 0],   //历史记录\n\n            eventid: 0,          //事件id\n            event_count: 0,\n            event_step: [0, 1],    //开奖格子,数组[24]\n            event_area: 0,       //开奖区域,数组[24]\n            event_times: 0,      //倍数,数组[24]\n            event_score: 0,      //当前赢分,数组[24]\n        }\n\n    //倍率\n    times = [5, 10, 15, 20, 30, 40, 100];\n\n    //0苹果、1橙子、2木瓜、3铃铛、4西瓜、5双星、677、7bar,8lucky\n    //倍率：5,10,15,20,30,40,100\n\n    serverStepName = ['橙子', '铃铛', '小bar', 'bar', '苹果', '小苹果', '木瓜', '西瓜', '小西瓜', 'lucky', '苹果', '小橙子', '橙子', '铃铛', '小77', '77', '苹果', '小木瓜', '木瓜',\n        '双星', '小双星', 'lucky', '苹果', '小铃铛'];\n\n    //格子对应的中奖区域\n    serverStepArea = [1, 3, 17, 7, 0, 10, 2, 4, 14, 8, 0, 11, 1, 3, 16, 6, 0, 12, 2, 5, 15, 8, 0, 13];\n\n    //游戏状态\n    gameState = 0; //0-初始-下注，1-结束，2-收分，3\n\n    start() {\n        globalThis.curgame = this;\n        this.gameState = 0;\n        globalThis.sgj_normal.play()\n    }\n\n    //模拟服务器数据\n    getServerData() {\n\n        //获取随机--中奖格子\n        let t_step = randomRangeInt(1, 25);\n\n        //倍数\n        let bs = randomRangeInt(0, 8);\n\n        //获取玩家下注总和\n        let mybetscore = 0;\n        for (let i = 0; i < 8; i++) {\n            mybetscore += globalThis.sgj_view.bet_score[i];\n        }\n\n        //获取中奖区域\n        let t_area = this.serverStepArea[t_step];\n        if (t_area > 9) t_area = t_area - 10;\n\n        //判断玩家是否中奖\n        let winscore = 0;\n        if (t_area == 8) //中lucky、随机1到99倍、送灯\n        {\n            winscore = mybetscore * randomRangeInt(1, 99);\n        }\n        else if (globalThis.sgj_view.bet_score[t_area] > 0)  //普通中奖 下注*倍数\n        {\n            winscore = globalThis.sgj_view.bet_score[t_area] * this.cmd_s_gameEnd.tiems;\n        }\n        else    //不中奖\n        {\n            winscore = 0;\n        }\n\n        //赋值数据\n        this.cmd_s_gameEnd.step = t_step;   //中奖格子\n        this.cmd_s_gameEnd.area = t_area;   //中奖区域\n        this.cmd_s_gameEnd.tiems = this.times[bs];  //中奖倍数\n        this.cmd_s_gameEnd.wins_core = winscore;    //中奖得分\n\n        return this.cmd_s_gameEnd;\n    }\n\n    update(deltaTime: number) {\n\n    }\n\n    onEnable() {\n        globalThis.sgjEvent.on('sgj_runcallback', this.runCallBack, this);\n    }\n\n    onDisable() {\n        globalThis.sgjEvent.off('sgj_runcallback', this.runCallBack, this);\n    }\n\n    runCallBack(arg1: string) {\n        console.log('水果机回调函数:', arg1);\n\n        console.log('结束数据：', this.cmd_s_gameEnd)\n        //特殊中奖\n        if (this.cmd_s_gameEnd.eventid > 0) {\n            return;\n        }\n\n        //普通中奖、闪灯\n        if (this.cmd_s_gameEnd.wins_core > 0) {\n            globalThis.sgj_view.setWinScore(this.cmd_s_gameEnd.wins_core);\n            this.gameState = 1;\n            return;\n        }\n\n        //没有中奖\n        this.gameState = 0;\n\n    }\n\n    //接受消息\n    onMessage(type, data) {\n        console.log('收到服务器消息：', data);\n    }\n\n    //发送消息\n    sendMssage(type: any, data: any) {\n        let msg = {\n            type: type,\n            data: data,\n        }\n        HTTP.getInstance().send(JSON.stringify(msg));\n    }\n}"]}