{"version":3,"sources":["file:///Users/zzx/Desktop/naga123/client/assets/script/sgj/sgj_run.ts"],"names":["_decorator","Component","AudioMgr","ccclass","property","sgj_run","startIndex","endIndex","runCount","start","globalThis","play","update","deltaTime","resetMask","schedule","updateMask","inst","playOneShot","stop","unschedule","i","sgj_view","mask_node","active","light_node","eventTargets","emit"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;AACZC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBJ,U;;yBAGjBK,O,WADZF,OAAO,CAAC,SAAD,C,gBAAR,MACaE,OADb,SAC6BJ,SAD7B,CACuC;AAAA;AAAA;AAAA,eAEnCK,UAFmC,GAEtB,CAFsB;AAAA,eAGnCC,QAHmC,GAGxB,CAHwB;AAAA,eAInCC,QAJmC,GAIxB,EAJwB;AAAA;;AAMnCC,QAAAA,KAAK,GAAG;AACJC,UAAAA,UAAU,CAACL,OAAX,GAAqB,IAArB;AACA,eAAKM,IAAL,CAAU,CAAV;AACH;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AAEDF,QAAAA,IAAI,CAACJ,QAAD,EAAW;AACX,eAAKD,UAAL,GAAkB,CAAlB;AACA,eAAKC,QAAL,GAAgBA,QAAQ,GAAG,KAAKC,QAAhC,CAFW,CAE+B;;AAC1C,eAAKM,SAAL;AACA,eAAKC,QAAL,CAAc,KAAKC,UAAnB,EAA+B,GAA/B;AACA;AAAA;AAAA,oCAASC,IAAT,CAAcC,WAAd,CAA0B,qBAA1B;AACH;;AAEDC,QAAAA,IAAI,GAAG;AACH,eAAKC,UAAL,CAAgB,KAAKJ,UAArB;AACH;;AAEDF,QAAAA,SAAS,GAAG;AACR,eAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AACzBX,YAAAA,UAAU,CAACY,QAAX,CAAoBC,SAApB,CAA8BF,CAA9B,EAAiCG,MAAjC,GAA0C,KAA1C;AACAd,YAAAA,UAAU,CAACY,QAAX,CAAoBG,UAApB,CAA+BJ,CAA/B,EAAkCG,MAAlC,GAA2C,KAA3C;AACH;AACJ;;AAEDR,QAAAA,UAAU,GAAG;AACT;AACA,cAAI,KAAKV,UAAL,IAAmB,KAAKC,QAA5B,EAAsC;AAClC,iBAAKa,UAAL,CAAgB,KAAKJ,UAArB;AACAN,YAAAA,UAAU,CAACgB,YAAX,CAAwBC,IAAxB,CAA6B,cAA7B,EAA6C,OAA7C;AACA;AACH;;AAED,eAAK,IAAIN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AACzB;AACA,gBAAI,KAAKf,UAAL,IAAmBe,CAAvB,EAA0B;AACtBX,cAAAA,UAAU,CAACY,QAAX,CAAoBC,SAApB,CAA8BF,CAA9B,EAAiCG,MAAjC,GAA0C,IAA1C;AACAd,cAAAA,UAAU,CAACY,QAAX,CAAoBG,UAApB,CAA+BJ,CAA/B,EAAkCG,MAAlC,GAA2C,IAA3C;AACH,aAHD,MAIK;AACDd,cAAAA,UAAU,CAACY,QAAX,CAAoBC,SAApB,CAA8BF,CAA9B,EAAiCG,MAAjC,GAA0C,KAA1C;AACAd,cAAAA,UAAU,CAACY,QAAX,CAAoBG,UAApB,CAA+BJ,CAA/B,EAAkCG,MAAlC,GAA2C,KAA3C;AACH;AACJ;AAIJ;;AAxDkC,O","sourcesContent":["import { _decorator, Component, Node, Sprite } from 'cc';\nimport { AudioMgr } from '../utils/AudioMgr';\nconst { ccclass, property } = _decorator;\n\n@ccclass('sgj_run')\nexport class sgj_run extends Component {\n\n    startIndex = 0;\n    endIndex = 0;\n    runCount = 72;\n\n    start() {\n        globalThis.sgj_run = this;\n        this.play(7);\n    }\n\n    update(deltaTime: number) {\n\n    }\n\n    play(endIndex) {\n        this.startIndex = 0;\n        this.endIndex = endIndex + this.runCount; //中奖格子加上圈数\n        this.resetMask();\n        this.schedule(this.updateMask, 0.6);\n        AudioMgr.inst.playOneShot('sound/sgj/turnstep1');\n    }\n\n    stop() {\n        this.unschedule(this.updateMask);\n    }\n\n    resetMask() {\n        for (let i = 0; i < 24; i++) {\n            globalThis.sgj_view.mask_node[i].active = false;\n            globalThis.sgj_view.light_node[i].active = false;\n        }\n    }\n\n    updateMask() {\n        //中奖结束回调\n        if (this.startIndex == this.endIndex) {\n            this.unschedule(this.updateMask);\n            globalThis.eventTargets.emit('sgj_callback', '中奖结束!');\n            return;\n        }\n\n        for (let i = 0; i < 24; i++) {\n            //当前高亮的格子\n            if (this.startIndex == i) {\n                globalThis.sgj_view.mask_node[i].active = true;\n                globalThis.sgj_view.light_node[i].active = true;\n            }\n            else {\n                globalThis.sgj_view.mask_node[i].active = false;\n                globalThis.sgj_view.light_node[i].active = false;\n            }\n        }\n\n\n\n    }\n}\n\n\n\n"]}